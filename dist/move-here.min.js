var babelHelpers={};babelHelpers.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},babelHelpers.createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var MotionDirection=Object.defineProperties({},{CURVE_RANDOM:{enumerable:!0,value:"curveRandom"}}),Rectangle=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=e.x,n=void 0===i?0:i,o=e.y,a=void 0===o?-0:o,s=e.width,r=void 0===s?0:s,h=e.height,u=void 0===h?0:h;babelHelpers.classCallCheck(this,t),this._x=n,this._y=a,this._width=r,this._height=u,this._halfWidth=r/2,this._halfHeight=u/2,this._eighthWidth=r/8,this._eighthHeight=u/8}return babelHelpers.createClass(t,[{key:"x",set:function(t){this._x=t},get:function(){return this._x}},{key:"y",set:function(t){this._y=t},get:function(){return this._y}},{key:"width",set:function(t){this._width=t,this._halfWidth=t/2,this._eighthWidth=t/8},get:function(){return this._width}},{key:"height",set:function(t){this._height=t,this._halfHeight=t/2,this._eighthHeight=t/8},get:function(){return this._height}},{key:"halfWidth",get:function(){return this._halfWidth}},{key:"halfHeight",get:function(){return this._halfHeight}},{key:"eighthWidth",get:function(){return this._eighthWidth}},{key:"eighthHeight",get:function(){return this._eighthHeight}}]),t}(),Status=Object.freeze({BORN:"born",ALIVE:"alive",DYING:"dying",DEAD:"dead"}),id=0,IdGenerator=function(){function t(){babelHelpers.classCallCheck(this,t)}return babelHelpers.createClass(t,null,[{key:"getId",value:function(){return id++}}]),t}(),TARGET_FRAME_RATE=60,MIN_ROTATION_PER_FRAME=1,MotionAsset=function(){function t(e,i,n,o,a,s,r,h,u){babelHelpers.classCallCheck(this,t),this._id=IdGenerator.getId(),this._target=e,this._initTimeInMilliseconds=i,this._duration=n,this._unitsPerSecond=o,this._rotationPerSecond=a,this._rotationPerFrame=a/TARGET_FRAME_RATE,this._motionDirection=s,this._rotateToDirection=r,this._unitsPerFrame=o/TARGET_FRAME_RATE,this._simulateDepth=h,this._spawnLocation=u,this._acquireRotationDirection=!1,this._destinationX=0,this._destinationY=0,this._status=Status.BORN,this._rotationAmount=0,this._rotationDirection=1,this._rotationProxy=0,this._rotationPerFrame<MIN_ROTATION_PER_FRAME&&(this._rotationPerFrame=MIN_ROTATION_PER_FRAME)}return babelHelpers.createClass(t,[{key:"id",get:function(){return this._id}},{key:"target",get:function(){return this._target}},{key:"duration",get:function(){return this._duration}},{key:"unitsPerSecond",get:function(){return this._unitsPerSecond}},{key:"unitsPerFrame",get:function(){return this._unitsPerFrame}},{key:"status",set:function(t){this._status=t},get:function(){return this._status}},{key:"initTime",set:function(t){this._initTimeInMilliseconds=t},get:function(){return this._initTimeInMilliseconds}},{key:"x",set:function(t){this._target.x=t},get:function(){return this._target.x}},{key:"y",set:function(t){this._target.y=t},get:function(){return this._target.y}},{key:"width",get:function(){return this._target.width||0}},{key:"height",get:function(){return this._target.height||0}},{key:"rotation",set:function(t){this._rotateToDirection?this._target.rotation=t:this._rotationProxy=t},get:function(){return this._rotateToDirection?this._target.rotation:this._rotationProxy}},{key:"destinationX",set:function(t){this._destinationX=t},get:function(){return this._destinationX}},{key:"destinationY",set:function(t){this._destinationY=t},get:function(){return this._destinationY}},{key:"rotationPerSecond",get:function(){return this._rotationPerSecond}},{key:"rotationPerFrame",get:function(){return this._rotationPerFrame}},{key:"motionDirection",get:function(){return this._motionDirection}},{key:"rotateToDirection",set:function(t){this._rotateToDirection=t},get:function(){return this._rotateToDirection}},{key:"acquireRotationDirection",set:function(t){this._acquireRotationDirection=t},get:function(){return this._acquireRotationDirection}},{key:"rotationAmount",set:function(t){this._rotationAmount=t},get:function(){return this._rotationAmount}},{key:"rotationDirection",set:function(t){this._rotationDirection=t},get:function(){return this._rotationDirection}},{key:"simulateDepth",set:function(t){this._simulateDepth=t},get:function(){return this._simulateDepth}},{key:"spawnLocation",set:function(t){this._spawnLocation=t},get:function(){return this._spawnLocation}}]),t}(),RADIANS_CONVERSION=Math.PI/180,DEGREES_CONVERSION=180/Math.PI,Mathy=function(){function t(){babelHelpers.classCallCheck(this,t)}return babelHelpers.createClass(t,null,[{key:"radians",value:function(t){return RADIANS_CONVERSION*t}},{key:"degrees",value:function(t){return DEGREES_CONVERSION*t}},{key:"normalizeAngle",value:function(t){if(t>360)for(;t>360;)t-=360;else if(-360>t)for(;-360>t;)t+=360;return t}},{key:"getMinAngleDiff",value:function(t,e){if(0>=t&&e>=0||t>=0&&0>=e){var i=t>0?t:-t,n=e>0?e:-e,o=180-i,a=180-n;return Math.min(o+a,i+n)}var s=t-e;return s>0?s:-s}},{key:"convertRotationToAngle",value:function(e,i,n){var o=void 0;return o=i>=0&&0>n?90+e:i>=0&&n>=0?e-90:0>i&&n>=0?e+270:e+90,t.normalizeAngle(o)}},{key:"convertAngleToRotation",value:function(t,e,i){var n=void 0;return n=e>=0&&0>i?90-t:e>=0&&i>=0?90+t:0>e&&i>=0?-270+t:90-t}},{key:"distanceBetweenTwoPoints",value:function(t,e,i,n){return Math.sqrt((t-i)*(t-i)+(e-n)*(e-n))}},{key:"getRandomPointInsideRect",value:function(t,e){var i=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],n={min:0,max:0},o={min:0,max:0},a={x:0,y:0};return i?(t.x<e.x+e.halfWidth?(n.min=e.eighthWidth,n.max=e.halfWidth-n.min):(n.min=-e.eighthWidth,n.max=-e.halfWidth-n.min),t.y<e.y+e.halfHeight?(o.min=e.eighthHeight,o.max=e.halfHeight-o.min):(o.min=-e.eighthHeight,o.max=-e.halfHeight-o.min)):(n.min=e.x,n.max=e.width,o.min=e.y,o.max=e.height),a.x=t.x+Math.round(n.min+Math.random()*n.max),a.y=t.y+Math.round(o.min+Math.random()*o.max),a.x>e.x+e.width?a.x=e.x+e.width:a.x<e.x&&(a.x=e.x),a.y>e.y+e.height?a.y=e.y+e.height:a.y<e.y&&(a.y=e.y),a}},{key:"getRandomPointOutsideRect",value:function(t,e){var i={x:0,y:0},n=Math.floor(4*Math.random());switch(n){case 0:i.x=e.x-t.width,i.y=e.y+Math.round(Math.random()*e.height);break;case 1:i.x=e.x+Math.round(Math.random()*e.width),i.y=e.y-t.height;break;case 2:i.x=e.x+e.width+t.width,i.y=e.y+Math.round(Math.random()*e.height);break;case 3:i.x=e.x+Math.round(Math.random()*e.width),i.y=e.y+e.height+t.height}return i}}]),t}(),MIN_SCALE=.5,MAX_SCALE=1.5,getPositionDelta=function(t){var e={};return e.x=t.destinationX-t.x,e.y=t.destinationY-t.y,e},setNewDestinationPoint=function(t,e,i){var n=void 0;n="inside"===i?Mathy.getRandomPointInsideRect(t,e):Mathy.getRandomPointOutsideRect(t,e),t.destinationX=n.x,t.destinationY=n.y},resetRotationDirection=function(t){t.acquireRotationDirection=!0,t.rotationAmount=0},setAssetStateBasedOnTime=function(t,e,i){t.status===Status.ALIVE&&-1!==t.duration&&e-t.initTime>=t.duration&&(setNewDestinationPoint(t,i,"outside"),resetRotationDirection(t),t.status=Status.DYING)},setScale=function(t,e){if(t.simulateDepth){var i=MIN_SCALE+(t.y-e.y)/e.height*(MAX_SCALE-MIN_SCALE);MIN_SCALE>i&&(i=MIN_SCALE),i>MAX_SCALE&&(i=MAX_SCALE),t.scaleX=t.scaleY=i}},setRotation=function(t,e){var i=Mathy.distanceBetweenTwoPoints(t.x,t.y,t.destinationX,t.destinationY);if(0!==i){var n=t.rotation,o=Math.round(Mathy.degrees(Math.acos(e.x/i))),a=Mathy.convertAngleToRotation(o,e.x,e.y),s=Mathy.getMinAngleDiff(a,n);if(s<=t.rotationPerFrame)n=a;else{t.acquireRotationDirection&&(t.acquireRotationDirection=!1,n>o?t.rotationDirection=-1:t.rotationDirection=1);var r=t.rotationAmount/360<=1?1:t.rotationAmount/360;n+=t.rotationDirection*t.rotationPerFrame*r,n=Mathy.normalizeAngle(n)}t.rotationAmount+=Mathy.getMinAngleDiff(t.rotation,n),t.rotation=n}},setTranslation=function(t,e){if(Math.abs(e.x)<t.unitsPerFrame&&Math.abs(e.y)<t.unitsPerFrame)t.status===Status.DYING&&(t.status=Status.DEAD),t.x=t.destinationX,t.y=t.destinationY;else{var i=Mathy.radians(Mathy.convertRotationToAngle(t.rotation,e.x,e.y));e.y<0?(t.x-=Math.cos(i)*t.unitsPerFrame,t.y-=Math.sin(i)*t.unitsPerFrame):(t.x+=Math.cos(i)*t.unitsPerFrame,t.y+=Math.sin(i)*t.unitsPerFrame)}},doesAssetNeedNewDestinationPoint=function(t){return t.x===t.destinationX&&t.y===t.destinationY},RandomMotionAdapter=function(){function t(e){babelHelpers.classCallCheck(this,t),this._boundingRectangle=e,this._motionAssets={}}return babelHelpers.createClass(t,[{key:"addAsset",value:function(t){var e=void 0;e="inside"===t.spawnLocation?Mathy.getRandomPointInsideRect(t,this._boundingRectangle,!1):Mathy.getRandomPointOutsideRect(t,this._boundingRectangle),t.x=e.x,t.y=e.y,setNewDestinationPoint(t,this._boundingRectangle,"inside"),resetRotationDirection(t),setScale(t,this._boundingRectangle),t.status=Status.ALIVE,this._motionAssets[t.id]=t}},{key:"update",value:function(t){var e=this,i=void 0,n=void 0;Object.keys(this._motionAssets).forEach(function(o){i=e._motionAssets[o],setAssetStateBasedOnTime(i,t,e._boundingRectangle),n=getPositionDelta(i),setScale(i,e._boundingRectangle),setRotation(i,n),setTranslation(i,n),doesAssetNeedNewDestinationPoint(i)&&(setNewDestinationPoint(i,e._boundingRectangle,"inside"),resetRotationDirection(i)),i.status===Status.DEAD&&delete e._motionAssets[o]})}}]),t}(),Timer=function(){function t(){babelHelpers.classCallCheck(this,t),this._requestAnimationId=null,this._paused=!0,this._currentTime=0,this._lastTime=0,this._timeInMilliseconds=0,this._timeUpdateHandlers=[]}return babelHelpers.createClass(t,[{key:"_tick",value:function(){var t=this;this._requestAnimationId=null,this._currentTime=performance.now(),this._timeInMilliseconds+=this._currentTime-this._lastTime,this._lastTime=this._currentTime,this._timeUpdateHandlers.every(function(e){e(t._timeInMilliseconds)}),this._paused||(this._requestAnimationId=requestAnimationFrame(function(){return t._tick()}))}},{key:"addTimeUpdateListener",value:function(t){this._timeUpdateHandlers.push(t)}},{key:"play",value:function(){var t=this;this._paused=!1,this._lastTime=performance.now(),this._requestAnimationId=requestAnimationFrame(function(){return t._tick()})}},{key:"pause",value:function(){this._requestAnimationId&&(cancelAnimationFrame(this._requestAnimationId),this._requestAnimationId=null),this._paused=!0}},{key:"paused",get:function(){return this._paused}},{key:"time",get:function(){return this._timeInMilliseconds}}]),t}(),MIN_DURATION=2e3,MIN_UNITS_PER_SECOND=30,MIN_ROTATION_SPEED_MODIFIER=1,MotionEngine=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?new Rectangle:arguments[0];babelHelpers.classCallCheck(this,t),this._boundingRectangle=e,this._timer=new Timer,this._adaptersMap={};var i=new RandomMotionAdapter(this._boundingRectangle);this._timer.addTimeUpdateListener(i.update.bind(i)),this._adaptersMap[MotionDirection.CURVE_RANDOM]=i}return babelHelpers.createClass(t,[{key:"start",value:function(){this._timer.play()}},{key:"stop",value:function(){this._timer.pause()}},{key:"addAsset",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.target,i=void 0===e?null:e,n=t.motionDirection,o=void 0===n?MotionDirection.CURVE_RANDOM:n,a=t.duration,s=void 0===a?MIN_DURATION:a,r=t.unitsPerSecond,h=void 0===r?MIN_UNITS_PER_SECOND:r,u=t.rotationSpeedModifier,c=void 0===u?MIN_ROTATION_SPEED_MODIFIER:u,d=t.rotateToDirection,l=void 0===d?!0:d,_=t.simulateDepth,g=void 0===_?!1:_,f=t.spawnLocation,m=void 0===f?"outside":f,y=this._adaptersMap[o];if(!y)throw new Error("MotionEngine - No motion adapter found with supplied motion direction of ("+o+")");var M=Math.round(h*c),A=new MotionAsset(i,this._timer.time,s,h,M,o,l,g,m);return y.addAsset(A),A}},{key:"paused",get:function(){return this._timer.paused}}]),t}(),MoveHere=window.MoveHere=window.MoveHere||{};MoveHere.MotionDirection=MotionDirection,MoveHere.Rectangle=Rectangle,MoveHere.MotionEngine=MotionEngine;